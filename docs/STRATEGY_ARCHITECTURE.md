# MTF 차트 네비게이터 V3 - 전략 설계도

## Version History

| 버전 | 날짜 | 변경사항 | 커밋 |
|-----|------|---------|------|
| v3.0 | 2024-12-30 | 폴더 구조 개편, 문서 docs/ 이동 | - |
| v2.0 | 2024-12-28 | MTF V3 설계 완료, Re-Accumulation/Re-Distribution 패턴 추가 | - |
| v1.0 | 2024-12-26 | 초기 버전, 기본 Wyckoff + RSI 다이버전스 구조 | - |

---

## 1. 전체 시스템 구조

```
┌─────────────────────────────────────────────────────────────────────┐
│                        데이터 입력                                   │
│                    [5분봉 OHLCV 데이터]                              │
│                         │                                           │
│         ┌───────────────┼───────────────┬───────────────┐           │
│         ▼               ▼               ▼               ▼           │
│    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐        │
│    │ 5분봉   │    │ 15분봉  │    │ 1시간봉  │    │ 4시간봉  │        │
│    │ (원본)  │    │(리샘플링)│    │(리샘플링)│    │(리샘플링)│        │
│    └────┬────┘    └────┬────┘    └────┬────┘    └────┬────┘        │
│         │              │              │              │              │
│         ▼              ▼              ▼              ▼              │
│    ┌─────────┐    ┌─────────┐    ┌─────────┐    ┌─────────┐        │
│    │ 진입    │    │ 다이버  │    │ 와이코프 │    │ 대추세   │        │
│    │ 타이밍  │    │ 전스    │    │ 구조    │    │ 필터    │        │
│    └────┬────┘    └────┬────┘    └────┬────┘    └────┬────┘        │
│         │              │              │              │              │
│         └──────────────┴──────────────┴──────────────┘              │
│                               │                                      │
│                               ▼                                      │
│                    ┌─────────────────────┐                          │
│                    │    점수 계산 엔진    │                          │
│                    │  (롱/숏 스코어링)   │                          │
│                    └──────────┬──────────┘                          │
│                               │                                      │
│                               ▼                                      │
│                    ┌─────────────────────┐                          │
│                    │    신호 필터링       │                          │
│                    │ (최소점수/TF정렬/RR) │                          │
│                    └──────────┬──────────┘                          │
│                               │                                      │
│                               ▼                                      │
│                    ┌─────────────────────┐                          │
│                    │   매매 신호 출력     │                          │
│                    │ LONG / SHORT / WAIT │                          │
│                    └─────────────────────┘                          │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 2. 타임프레임별 역할

```
┌─────────────────────────────────────────────────────────────────────┐
│                                                                      │
│   4시간봉 ──────────────────────────────────────────────────────    │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  역할: "어느 방향으로 매매할 것인가" (대추세 필터)            │   │
│   │                                                              │   │
│   │  분석 요소:                                                  │   │
│   │  • EMA 50 / EMA 200 위치                                    │   │
│   │  • 골든크로스 / 데드크로스                                   │   │
│   │                                                              │   │
│   │  판정:                                                       │   │
│   │  • 가격 > EMA50 > EMA200 → BULLISH (+2점)                   │   │
│   │  • 가격 < EMA50 < EMA200 → BEARISH (+2점)                   │   │
│   │  • 그 외 → NEUTRAL (0점)                                    │   │
│   │                                                              │   │
│   │  역추세 페널티: 반대 방향 매매 시 -2점                       │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                              │                                       │
│                              ▼                                       │
│   1시간봉 ──────────────────────────────────────────────────────    │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  역할: "어떤 구조에서 매매할 것인가" (와이코프 구조)          │   │
│   │                                                              │   │
│   │  분석 요소:                                                  │   │
│   │  • 50봉 박스 범위 (고점/저점)                                │   │
│   │  • 스프링: 박스 하단 돌파 후 빠르게 복귀                     │   │
│   │  • 업쓰러스트: 박스 상단 돌파 후 빠르게 복귀                 │   │
│   │  • Higher Lows / Lower Highs 패턴                           │   │
│   │  • 거래량 패턴 (조용한 흡수형)                              │   │
│   │                                                              │   │
│   │  === 전통적 패턴 (바닥/고점권) ===                          │   │
│   │  ┌─────────────┬─────────────────────────────────┐          │   │
│   │  │ 페이즈      │ 조건                            │          │   │
│   │  ├─────────────┼─────────────────────────────────┤          │   │
│   │  │ ACCUMULATION│ 박스권 + 스프링 감지 → 롱 +2점  │          │   │
│   │  │ DISTRIBUTION│ 박스권 + 업쓰러스트 → 숏 +2점   │          │   │
│   │  │ MARKUP      │ 박스 상단 돌파 → 롱 +1점        │          │   │
│   │  │ MARKDOWN    │ 박스 하단 돌파 → 숏 +1점        │          │   │
│   │  │ RANGING     │ 횡보 → 0점                     │          │   │
│   │  └─────────────┴─────────────────────────────────┘          │   │
│   │                                                              │   │
│   │  === 추세 중 패턴 (Re-Accumulation / Re-Distribution) ===   │   │
│   │  ┌───────────────┬───────────────────────────────┐          │   │
│   │  │ 페이즈        │ 조건                          │          │   │
│   │  ├───────────────┼───────────────────────────────┤          │   │
│   │  │ RE_ACCUMULATION│ 상승추세 + Higher Lows       │          │   │
│   │  │               │ + 조용한 거래량 → 롱 +2.5점   │          │   │
│   │  │               │ (추세 순응이라 더 높은 점수)  │          │   │
│   │  ├───────────────┼───────────────────────────────┤          │   │
│   │  │ RE_DISTRIBUTION│ 하락추세 + Lower Highs       │          │   │
│   │  │               │ + 조용한 거래량 → 숏 +2.5점   │          │   │
│   │  │               │ (추세 순응이라 더 높은 점수)  │          │   │
│   │  └───────────────┴───────────────────────────────┘          │   │
│   │                                                              │   │
│   │  ★ Re-Accumulation: 상승 중 쉬어가는 구간                   │   │
│   │    → 큰 손들이 추가 물량 흡수                               │   │
│   │  ★ Re-Distribution: 하락 중 쉬어가는 구간                   │   │
│   │    → 보유 물량 추가 매도                                    │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                              │                                       │
│                              ▼                                       │
│   15분봉 ──────────────────────────────────────────────────────     │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  역할: "반전 신호가 있는가" (RSI 다이버전스)                  │   │
│   │                                                              │   │
│   │  ★ 핵심: Stoch RSI 필터링                                   │   │
│   │  • Stoch RSI < 30 구간에서만 저점 체크 (Bullish용)           │   │
│   │  • Stoch RSI > 70 구간에서만 고점 체크 (Bearish용)           │   │
│   │                                                              │   │
│   │  다이버전스 감지:                                            │   │
│   │  ┌────────────────────────────────────────────────────────┐ │   │
│   │  │ Regular Bullish: 가격 LL + RSI HL → 롱 +2점 × 강도     │ │   │
│   │  │ Hidden Bullish:  가격 HL + RSI LL → 롱 +1.6점 × 강도   │ │   │
│   │  │ Regular Bearish: 가격 HH + RSI LH → 숏 +2점 × 강도     │ │   │
│   │  │ Hidden Bearish:  가격 LH + RSI HH → 숏 +1.6점 × 강도   │ │   │
│   │  └────────────────────────────────────────────────────────┘ │   │
│   │                                                              │   │
│   │  피보나치 레벨 계산:                                         │   │
│   │  • 100봉 스윙 고점/저점 기준                                 │   │
│   │  • 0.236, 0.382, 0.5, 0.618, 0.786                          │   │
│   │  • 가장 가까운 지지선 → SL 참고                             │   │
│   │  • 가장 가까운 저항선 → TP 설정                             │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                              │                                       │
│                              ▼                                       │
│   5분봉 ──────────────────────────────────────────────────────      │
│   ┌─────────────────────────────────────────────────────────────┐   │
│   │  역할: "지금 진입해도 되는가" (진입 타이밍)                   │   │
│   │                                                              │   │
│   │  Stoch RSI 분석:                                             │   │
│   │  • K값 < 20 → 과매도 (롱 준비)                              │   │
│   │  • K값 > 80 → 과매수 (숏 준비)                              │   │
│   │  • K선이 D선 상향돌파 → 롱 +1점                             │   │
│   │  • K선이 D선 하향돌파 → 숏 +1점                             │   │
│   │                                                              │   │
│   │  반전 캔들 패턴:                                             │   │
│   │  • 과매도 + 망치형/상승장악형 → 롱 +1.5점                   │   │
│   │  • 과매수 + 역망치형/하락장악형 → 숏 +1.5점                 │   │
│   └─────────────────────────────────────────────────────────────┘   │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 3. 점수 계산 시스템

```
┌─────────────────────────────────────────────────────────────────────┐
│                         점수 계산 엔진                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                    롱 스코어 (LONG_SCORE)                    │    │
│  ├─────────────────────────────────────────────────────────────┤    │
│  │  [4시간봉]                                                   │    │
│  │    • 상승추세 (BULLISH)           : +2.0점                  │    │
│  │    • 하락추세 시 페널티            : -2.0점                  │    │
│  │                                                              │    │
│  │  [1시간봉]                                                   │    │
│  │    • 전통적 매집 (ACCUMULATION)   : +2.0점                  │    │
│  │    • 상승 중 매집 (RE_ACCUMULATION): +2.5점 (추세 순응)     │    │
│  │    • 스프링 감지                   : +1.5점                  │    │
│  │    • 마크업 구간 (MARKUP)          : +1.0점                  │    │
│  │                                                              │    │
│  │  [15분봉]                                                    │    │
│  │    • Bullish 다이버전스            : +2.0점 × 강도(0~1)      │    │
│  │                                                              │    │
│  │  [5분봉]                                                     │    │
│  │    • 과매도 구간                   : +1.0점                  │    │
│  │    • 반전 캔들                     : +1.5점                  │    │
│  │    • K선 상향돌파                  : +1.0점                  │    │
│  │                                                              │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  최대 가능 점수: 약 10~11점                                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                    숏 스코어 (SHORT_SCORE)                   │    │
│  ├─────────────────────────────────────────────────────────────┤    │
│  │  [4시간봉]                                                   │    │
│  │    • 하락추세 (BEARISH)           : +2.0점                  │    │
│  │    • 상승추세 시 페널티            : -2.0점                  │    │
│  │                                                              │    │
│  │  [1시간봉]                                                   │    │
│  │    • 전통적 분산 (DISTRIBUTION)   : +2.0점                  │    │
│  │    • 하락 중 분산 (RE_DISTRIBUTION): +2.5점 (추세 순응)     │    │
│  │    • 업쓰러스트 감지               : +1.5점                  │    │
│  │    • 마크다운 구간 (MARKDOWN)      : +1.0점                  │    │
│  │                                                              │    │
│  │  [15분봉]                                                    │    │
│  │    • Bearish 다이버전스            : +2.0점 × 강도(0~1)      │    │
│  │                                                              │    │
│  │  [5분봉]                                                     │    │
│  │    • 과매수 구간                   : +1.0점                  │    │
│  │    • 반전 캔들                     : +1.5점                  │    │
│  │    • K선 하향돌파                  : +1.0점                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 4. 신호 필터링 조건

```
┌─────────────────────────────────────────────────────────────────────┐
│                         신호 발생 조건                               │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  조건 1: 최소 점수                                           │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  • LONG_SCORE >= 4.0  또는  SHORT_SCORE >= 4.0               │    │
│  │  • 더 높은 점수의 방향으로 신호 발생                          │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  조건 2: 타임프레임 정렬 (TF Alignment)                       │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  • 최소 2개 이상의 타임프레임이 같은 방향에 동의해야 함       │    │
│  │                                                              │    │
│  │  예시 (LONG):                                                │    │
│  │    ✓ 4H 상승추세 + 1H 매집 = 2개 정렬 → 통과                │    │
│  │    ✓ 4H 상승추세 + 15M 다이버전스 = 2개 정렬 → 통과         │    │
│  │    ✗ 1H 매집만 = 1개 정렬 → 실패                           │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  조건 3: 손익비 (Risk/Reward Ratio)                          │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  • 손익비 >= 1.5 : 1 필수                                    │    │
│  │                                                              │    │
│  │  계산:                                                       │    │
│  │    LONG:  Reward = TP - Entry                               │    │
│  │           Risk   = Entry - SL                                │    │
│  │           RR     = Reward / Risk >= 1.5                      │    │
│  │                                                              │    │
│  │    SHORT: Reward = Entry - TP                               │    │
│  │           Risk   = SL - Entry                                │    │
│  │           RR     = Reward / Risk >= 1.5                      │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                      신호 출력                               │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │                                                              │    │
│  │  모든 조건 통과 시:                                          │    │
│  │  ┌────────────────────────────────────────────────────────┐ │    │
│  │  │  {                                                     │ │    │
│  │  │    action: "LONG" 또는 "SHORT",                       │ │    │
│  │  │    entry_price: 현재가,                                │ │    │
│  │  │    stop_loss: Entry - (ATR × 2.0),                    │ │    │
│  │  │    take_profit: 피보나치 저항선 또는 (Entry + ATR×4),  │ │    │
│  │  │    confidence: score / 10,                             │ │    │
│  │  │    timeframe_alignment: 정렬된 TF 개수                 │ │    │
│  │  │  }                                                     │ │    │
│  │  └────────────────────────────────────────────────────────┘ │    │
│  │                                                              │    │
│  │  조건 미충족 시: None (신호 없음)                            │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 5. 백테스트 실행 흐름

```
┌─────────────────────────────────────────────────────────────────────┐
│                      백테스트 메인 루프                              │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  초기 설정:                                                          │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  • 워밍업: 1000봉 (4시간봉 계산용)                           │    │
│  │  • 분석 간격: 24봉 (2시간마다)                               │    │
│  │  • 쿨다운: 72봉 (6시간)                                      │    │
│  │  • 최대 보유: 144봉 (12시간)                                 │    │
│  │  • 레버리지: 5x                                              │    │
│  │  • 포지션 크기: 15%                                          │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │                                                              │    │
│  │  FOR each bar in data:                                       │    │
│  │      │                                                       │    │
│  │      ├─► 1. 포지션 체크 (TP/SL/시간손절)                     │    │
│  │      │   └─► 청산 시 거래 기록                               │    │
│  │      │                                                       │    │
│  │      ├─► 2. 분석 주기 체크 (2시간마다)                       │    │
│  │      │   └─► YES → MTF 분석 실행                            │    │
│  │      │              └─► 신호 캐싱                            │    │
│  │      │                                                       │    │
│  │      └─► 3. 진입 조건 체크                                   │    │
│  │          ├─► 포지션 없음?                                   │    │
│  │          ├─► 쿨다운 지남?                                   │    │
│  │          └─► 캐시된 신호 있음?                              │    │
│  │              └─► YES → 포지션 오픈                          │    │
│  │                                                              │    │
│  │  END FOR                                                     │    │
│  │                                                              │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  결과 출력:                                                  │    │
│  │  • 총 수익률                                                 │    │
│  │  • 최대 낙폭 (MDD)                                          │    │
│  │  • 거래 횟수 (롱/숏)                                        │    │
│  │  • 승률                                                      │    │
│  │  • 손익비 (Profit Factor)                                   │    │
│  │  • 청산 횟수                                                 │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 6. TP/SL 계산 로직

```
┌─────────────────────────────────────────────────────────────────────┐
│                      TP/SL 계산 로직                                 │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  STOP LOSS (손절)                                            │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │                                                              │    │
│  │  LONG:  SL = Entry - (ATR × 2.0)                            │    │
│  │  SHORT: SL = Entry + (ATR × 2.0)                            │    │
│  │                                                              │    │
│  │  예시 (BTC $90,000, ATR $500):                              │    │
│  │    LONG SL  = 90,000 - (500 × 2) = $89,000                  │    │
│  │    SHORT SL = 90,000 + (500 × 2) = $91,000                  │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  TAKE PROFIT (익절)                                          │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │                                                              │    │
│  │  1차 시도: 피보나치 레벨 사용                                 │    │
│  │    LONG:  TP = 가장 가까운 저항선 (nearest_resistance)       │    │
│  │    SHORT: TP = 가장 가까운 지지선 (nearest_support)          │    │
│  │                                                              │    │
│  │  2차 (TP가 너무 가까우면): ATR 기반                          │    │
│  │    LONG:  TP = Entry + (ATR × 4.0)                          │    │
│  │    SHORT: TP = Entry - (ATR × 4.0)                          │    │
│  │                                                              │    │
│  │  손익비 체크:                                                │    │
│  │    RR = |TP - Entry| / |Entry - SL| >= 1.5 필수             │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 7. 실제 매매 예시

```
┌─────────────────────────────────────────────────────────────────────┐
│                     실제 매매 시나리오 예시                          │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│  상황: BTC $90,000 / ATR $500                                       │
│                                                                      │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [4시간봉 분석]                                              │    │
│  │  • EMA 50: $88,000                                          │    │
│  │  • EMA 200: $85,000                                         │    │
│  │  • 가격 > EMA50 > EMA200                                    │    │
│  │  → 판정: BULLISH (+2점, TF정렬 +1)                          │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [1시간봉 분석]                                              │    │
│  │  • 박스 범위: $88,500 ~ $91,000                             │    │
│  │  • 가격이 $88,600에서 $88,300으로 하락 후 $89,500 복귀       │    │
│  │  → 판정: ACCUMULATION + SPRING (+3.5점, TF정렬 +1)          │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [15분봉 분석]                                               │    │
│  │  • Stoch RSI: 25 (과매도 구간)                              │    │
│  │  • 이전 저점: $88,800 / RSI 35                              │    │
│  │  • 현재 저점: $88,300 / RSI 42                              │    │
│  │  • 가격 LL + RSI HL                                         │    │
│  │  → 판정: BULLISH DIVERGENCE (+1.4점, TF정렬 +1)             │    │
│  │                                                              │    │
│  │  • 피보나치 저항선: $91,500 (0.618)                         │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [5분봉 분석]                                                │    │
│  │  • Stoch RSI K: 18, D: 22                                   │    │
│  │  • 과매도 구간                                               │    │
│  │  • 망치형 캔들 출현                                          │    │
│  │  → 판정: 과매도 + 반전캔들 (+2.5점, TF정렬 +1)              │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [점수 합산]                                                 │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  LONG_SCORE = 2 + 3.5 + 1.4 + 2.5 = 9.4점                   │    │
│  │  TF 정렬 = 4개                                              │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [신호 검증]                                                 │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │  ✓ 점수 9.4 >= 4.0                                          │    │
│  │  ✓ TF 정렬 4 >= 2                                           │    │
│  │                                                              │    │
│  │  TP/SL 계산:                                                 │    │
│  │  • Entry: $90,000                                           │    │
│  │  • SL: $90,000 - ($500 × 2) = $89,000                       │    │
│  │  • TP: $91,500 (피보나치 저항선)                            │    │
│  │                                                              │    │
│  │  손익비 검증:                                                │    │
│  │  • Risk = $90,000 - $89,000 = $1,000                        │    │
│  │  • Reward = $91,500 - $90,000 = $1,500                      │    │
│  │  • RR = 1,500 / 1,000 = 1.5                                 │    │
│  │  ✓ RR 1.5 >= 1.5                                            │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                              │                                       │
│                              ▼                                       │
│  ┌─────────────────────────────────────────────────────────────┐    │
│  │  [최종 신호]                                                 │    │
│  │  ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━  │    │
│  │                                                              │    │
│  │  LONG 진입                                                   │    │
│  │  • Entry: $90,000                                           │    │
│  │  • SL: $89,000 (-1.11%)                                     │    │
│  │  • TP: $91,500 (+1.67%)                                     │    │
│  │  • 포지션: 15% × 5x = 75%                                   │    │
│  │  • 신뢰도: 94%                                              │    │
│  │                                                              │    │
│  └─────────────────────────────────────────────────────────────┘    │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## 8. 파일 구조

```
wpcn-backtester-cli-noflask/
├── src/wpcn/
│   ├── 000_config/              ← 전략 파라미터 설정
│   │   ├── symbols.py           ← BTC/ETH 개별 설정
│   │   ├── strategy.py          ← 전략 공통 설정
│   │   └── backtest.py          ← 백테스트 설정
│   │
│   ├── 001_crypto/001_binance/
│   │   ├── 001_spot/            ← 현물 매매
│   │   │   ├── 001_backtest/
│   │   │   ├── 002_live/
│   │   │   └── 003_legacy/
│   │   └── 002_futures/         ← 선물 매매
│   │       ├── 001_backtest/
│   │       ├── 002_live/
│   │       └── 003_legacy/
│   │
│   ├── 002_data/                ← 데이터 수집/처리
│   ├── 003_common/              ← 공통 모듈
│   │   ├── 001_core/
│   │   ├── 002_features/
│   │   ├── 003_wyckoff/
│   │   ├── 004_navigation/
│   │   └── 005_metrics/
│   │
│   ├── 006_engine/              ← 백테스트 엔진
│   ├── 007_reporting/           ← 차트/리포트
│   ├── 008_tuning/              ← 파라미터 최적화
│   └── 009_cli/                 ← CLI 인터페이스
│
├── results/001_crypto/001_binance/
│   ├── 001_spot/                ← 현물 결과
│   │   ├── BTC-USDT.json
│   │   ├── ETH-USDT.json
│   │   └── config_history_crypto_binance_spot.json
│   └── 002_futures/             ← 선물 결과
│       ├── BTC-USDT.json
│       ├── ETH-USDT.json
│       └── config_history_crypto_binance_futures.json
│
├── docs/
│   └── STRATEGY_ARCHITECTURE.md ← 이 문서
│
├── main.py                      ← 메인 진입점
└── run_futures_backtest_v2.py   ← 선물 백테스트 실행
```
